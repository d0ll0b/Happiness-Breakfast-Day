import{F as B}from"./FairyLoading-BT3QIXwH.js";import{A as P}from"./AlertMessages-jiiM__sS.js";import{_ as T,m as U,e as H,c as l,b as r,w as V,a as s,f as c,x as m,F as A,j as S,t as p,r as f,o as a,u as k,v as M,d as y}from"./index-Cax4zTSG.js";import{c as L}from"./cartStore-BICCevfF.js";var E={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"dollob_api",BASE_URL:"/Happiness-Breakfast-Day/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:g,VITE_APP_API_NAME:b}=E,N={data(){return{isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{FairyLoading:B,AlertMessages:P},computed:{...U(L,["carts","total","finalTotal"])},methods:{add_cart(i,t=1,_){let h="",o="";const d=`加入購物車成功，新增${t}筆商品~~`;this.isLoading=!0,_==="new"?(h=`${g}/api/${b}/cart`,o="post"):(h=`${g}/api/${b}/cart/${_}`,o="put");const x={product_id:i,qty:t};this.axios[o](h,{data:x}).then(u=>{this.get_cart(),this.$refs.AlertMessages.show_toast(d)}).catch(u=>{this.$refs.AlertMessages.show_alert(u==null?void 0:u.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1})},delete_cart(i=null){let t="",_="",h="";this.isLoading=!0,i===null?(h=confirm("是否清空購物車？"),t=`${g}/api/${b}/carts`,_="購物車已清空 ಥ_ಥ"):(h=confirm("是否刪除品項？"),t=`${g}/api/${b}/cart/${i}`,_="已從購物車刪除 ಥ_ಥ"),h&&this.axios.delete(t).then(o=>{this.get_cart(),this.$refs.AlertMessages.show_toast(_),this.$router.push("/home")}).catch(o=>{this.$refs.AlertMessages.show_alert(o==null?void 0:o.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1})},onSubmit(){const i=`${g}/api/${b}/order`;this.isLoading=!0,this.axios.post(i,{data:this.form}).then(t=>{this.get_cart(),this.$refs.form.resetForm(),this.form.message="",this.$refs.AlertMessages.show_toast("訂單已成交，謝謝~~"),this.$router.push("/home")}).catch(t=>{this.$refs.AlertMessages.show_alert(t==null?void 0:t.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1})},...H(L,["get_cart"])},mounted(){this.get_cart()}},I={class:"container"},z={class:"d-flex row flex-column flex-lg-row"},j={class:"d-flex justify-content-evenly bg-primary text-light mb-0 py-2"},q={class:"d-flex flex-column align-items-center"},D={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-1-circle-fill",viewBox:"0 0 16 16"},F=s("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312z"},null,-1),R=[F],O={key:1,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-1-circle",viewBox:"0 0 16 16"},Z=s("path",{d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"},null,-1),G=[Z],J=s("span",{class:"fw-bold"},"購物車",-1),K=s("hr",null,null,-1),Q={class:"d-flex flex-column align-items-center"},W={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-2-circle-fill",viewBox:"0 0 16 16"},X=s("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"},null,-1),Y=[X],ss={key:1,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-2-circle",viewBox:"0 0 16 16"},ts=s("path",{d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.646 6.24v.07H5.375v-.064c0-1.213.879-2.402 2.637-2.402 1.582 0 2.613.949 2.613 2.215 0 1.002-.6 1.667-1.287 2.43l-.096.107-1.974 2.22v.077h3.498V12H5.422v-.832l2.97-3.293c.434-.475.903-1.008.903-1.705 0-.744-.557-1.236-1.313-1.236-.843 0-1.336.615-1.336 1.306"},null,-1),es=[ts],os=s("span",{class:"fw-bold"},"訂購資訊",-1),ls=s("hr",null,null,-1),as={class:"d-flex flex-column align-items-center"},is={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-3-circle-fill",viewBox:"0 0 16 16"},ns=s("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-8.082.414c.92 0 1.535.54 1.541 1.318.012.791-.615 1.36-1.588 1.354-.861-.006-1.482-.469-1.54-1.066H5.104c.047 1.177 1.05 2.144 2.754 2.144 1.653 0 2.954-.937 2.93-2.396-.023-1.278-1.031-1.846-1.734-1.916v-.07c.597-.1 1.505-.739 1.482-1.876-.03-1.177-1.043-2.074-2.637-2.062-1.675.006-2.59.984-2.625 2.12h1.248c.036-.556.557-1.054 1.348-1.054.785 0 1.348.486 1.348 1.195.006.715-.563 1.237-1.342 1.237h-.838v1.072h.879Z"},null,-1),rs=[ns],ds=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-3-circle",viewBox:"0 0 16 16"},[s("path",{d:"M7.918 8.414h-.879V7.342h.838c.78 0 1.348-.522 1.342-1.237 0-.709-.563-1.195-1.348-1.195-.79 0-1.312.498-1.348 1.055H5.275c.036-1.137.95-2.115 2.625-2.121 1.594-.012 2.608.885 2.637 2.062.023 1.137-.885 1.776-1.482 1.875v.07c.703.07 1.71.64 1.734 1.917.024 1.459-1.277 2.396-2.93 2.396-1.705 0-2.707-.967-2.754-2.144H6.33c.059.597.68 1.06 1.541 1.066.973.006 1.6-.563 1.588-1.354-.006-.779-.621-1.318-1.541-1.318"}),s("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8"})],-1),cs=s("span",{class:"fw-bold"},"完成訂購",-1),hs={class:"col-12 col-lg-6 bg-primary","data-aos":"fade-right"},_s={class:"my-5 mt-4 row justify-content-center"},us=s("h2",{class:"text-light"},"訂購人資訊",-1),ms={class:"mb-3"},ps=s("label",{for:"email",class:"form-label"},"電子郵件",-1),fs=s("span",{class:"text-danger"}," *",-1),gs={class:"mb-3"},bs=s("label",{for:"name",class:"form-label"},"訂購人姓名",-1),vs=s("span",{class:"text-danger"}," *",-1),ws={class:"mb-3"},xs=s("label",{for:"tel",class:"form-label"},"電話",-1),ys=s("span",{class:"text-danger"}," *",-1),Vs={class:"mb-3"},As=s("label",{for:"address",class:"form-label"},"預定時間",-1),ks=s("span",{class:"text-danger"}," *",-1),Ms={class:"mb-3"},Ls=s("label",{for:"message",class:"form-label"},"留言",-1),$s={class:"text-end mb-4 d-none d-lg-flex justify-content-between"},Cs={class:"col-12 col-lg-6","data-aos":"fade-left"},Bs=s("div",{class:"d-flex mt-4 justify-content-between"},[s("div",null,[s("h2",{class:"text-primary"},"購物明細")])],-1),Ps={class:"table align-middle border-primary border-top border-start border-end mt-4"},Ts=s("thead",{class:"table-primary"},[s("tr",null,[s("th",{class:"text-start w-30"},"商品"),s("th",null,"單價"),s("th",{style:{width:"150px"}},"數量"),s("th",{class:"text-end"},"小計"),s("th")])],-1),Us={class:"text-start"},Hs=["src","alt"],Ss={key:0,class:"text-success"},Es={key:0,class:"text-success"},Ns={class:"input-group input-group-sm"},Is={class:"input-group"},zs=["onUpdate:modelValue","disabled","onBlur"],js={class:"input-group-text",id:"basic-addon2"},qs={class:"text-end"},Ds={key:0,class:"text-success"},Fs=["onClick"],Rs={key:0,class:"fas fa-spinner fa-pulse"},Os=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[s("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),s("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1),Zs={class:"table-primary"},Gs=s("td",{colspan:"4",class:"text-end"},"總計",-1),Js={colspan:"3",class:"text-center"},Ks={key:0},Qs=s("td",{colspan:"4",class:"text-end text-success"},"折扣價",-1),Ws={colspan:"3",class:"text-center text-success"},Xs={class:"text-end mb-4 d-flex justify-content-between d-lg-none"};function Ys(i,t,_,h,o,d){const x=f("fairy-loading"),u=f("VueLoading"),$=f("alert-messages"),v=f("v-field"),w=f("error-message"),C=f("v-form");return a(),l(A,null,[r(u,{active:o.isLoading},{default:V(()=>[r(x)]),_:1},8,["active"]),r($,{ref:"AlertMessages"},null,512),s("div",I,[s("div",z,[s("ul",j,[s("li",q,[this.$route.path==="/cart"?(a(),l("svg",D,R)):(a(),l("svg",O,G)),J]),K,s("li",Q,[this.$route.path==="/checkout"?(a(),l("svg",W,Y)):(a(),l("svg",ss,es)),os]),ls,s("li",as,[this.$route.path==="/home"?(a(),l("svg",is,rs)):c("",!0),ds,cs])]),s("div",hs,[s("div",_s,[us,r(C,{ref:"form",class:"mt-4",onSubmit:d.onSubmit},{default:V(({errors:e})=>[s("div",ms,[ps,fs,r(v,{id:"email",name:"email",type:"email",class:m(["form-control border-primary",{"is-invalid":e.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:o.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=n=>o.form.user.email=n)},null,8,["class","modelValue"]),r(w,{name:"email",class:"invalid-feedback"})]),s("div",gs,[bs,vs,r(v,{id:"name",name:"name",type:"text",class:m(["form-control border-primary",{"is-invalid":e.name}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=n=>o.form.user.name=n)},null,8,["class","modelValue"]),r(w,{name:"name",class:"invalid-feedback"})]),s("div",ws,[xs,ys,r(v,{id:"tel",name:"tel",type:"tel",class:m(["form-control border-primary",{"is-invalid":e.tel}]),placeholder:"請輸入電話",rules:"required|minMaxLength:8,10",modelValue:o.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=n=>o.form.user.tel=n)},null,8,["class","modelValue"]),r(w,{name:"tel",class:"invalid-feedback"})]),s("div",Vs,[As,ks,r(v,{id:"address",name:"address",type:"text",class:m(["form-control border-primary",{"is-invalid":e.address}]),placeholder:"請輸入預定時間",rules:"required",modelValue:o.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=n=>o.form.user.address=n)},null,8,["class","modelValue"]),r(w,{name:"address",class:"invalid-feedback"})]),s("div",Ms,[Ls,k(s("textarea",{id:"message",class:"form-control border-primary",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=n=>o.form.message=n)},null,512),[[M,o.form.message]])])]),_:1},8,["onSubmit"])]),s("div",$s,[s("div",null,[i.carts.length?(a(),l("button",{key:0,class:"btn btn-outline-danger",type:"button",onClick:t[5]||(t[5]=e=>d.delete_cart())},"清空購物車")):c("",!0)]),s("div",null,[s("button",{type:"submit",class:m(["btn btn-secondary text-light border-1 border-light",{disabled:!i.carts.length}]),onClick:t[6]||(t[6]=e=>d.onSubmit())},"送出訂單",2)])])]),s("div",Cs,[Bs,s("table",Ps,[Ts,s("tbody",null,[i.carts?(a(!0),l(A,{key:0},S(i.carts,e=>(a(),l("tr",{key:e.id},[s("td",Us,[s("img",{class:"me-3 product_img",src:e.product.imageUrl,alt:e.product.title},null,8,Hs),y(" "+p(e.product.title)+" ",1),e.coupon?(a(),l("div",Ss," 已套用優惠券 ")):c("",!0)]),s("td",null,[e.coupon?(a(),l("small",Es,"折扣價：")):c("",!0),y(" NT$"+p(e.product.price),1)]),s("td",null,[s("div",Ns,[s("div",Is,[k(s("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":n=>e.qty=n,disabled:o.isLoading,onBlur:n=>d.add_cart(e.product_id,e.qty,e.id)},null,40,zs),[[M,e.qty,void 0,{number:!0}]]),s("span",js,p(e.product.unit),1)])])]),s("td",qs,[e.coupon?(a(),l("small",Ds,"折扣價：")):c("",!0),y(" NT$"+p(e.product.price),1)]),s("td",null,[s("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>d.delete_cart(e.id)},[o.isLoading?(a(),l("i",Rs)):c("",!0),Os],8,Fs)])]))),128)):c("",!0)]),s("tfoot",Zs,[s("tr",null,[Gs,s("td",Js,"NT$ "+p(this.total),1)]),this.total!==this.finalTotal&&this.finalTotal?(a(),l("tr",Ks,[Qs,s("td",Ws,"NT$"+p(this.finalTotal),1)])):c("",!0)])]),s("div",Xs,[s("div",null,[i.carts.length?(a(),l("button",{key:0,class:"btn btn-outline-danger",type:"button",onClick:t[7]||(t[7]=e=>d.delete_cart())},"清空購物車")):c("",!0)]),s("div",null,[s("button",{type:"submit",class:m(["btn btn-primary text-light",{disabled:!i.carts.length}]),onClick:t[8]||(t[8]=e=>d.onSubmit())},"送出訂單",2)])])])])])],64)}const lt=T(N,[["render",Ys]]);export{lt as default};
