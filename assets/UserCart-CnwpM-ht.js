import{F as B}from"./FairyLoading-CchT2rnX.js";import{A as L,S as $}from"./AlertMessages-BEoNzY19.js";import{_ as T,m as P,e as N,c as a,b as u,w as m,a as t,f as d,F as b,j as A,t as c,x as E,r as p,o,d as x,u as H,v as S,k as I}from"./index-eUtDzQql.js";import{c as k}from"./cartStore-DSYSyEbq.js";import{N as U}from"./navigation-BGg4MDal.js";import{P as z,A as F}from"./autoplay-CKFyiEXk.js";var D={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"dollob_api",BASE_URL:"/Happiness-Breakfast-Day/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:g,VITE_APP_API_NAME:f}=D,R={data(){return{isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""},products:{}}},components:{FairyLoading:B,AlertMessages:L},setup(){return{modules:[z,U,F]}},computed:{...P(k,["carts","total","finalTotal"])},methods:{add_cart(l,e=1,n){let r="",i="";const h=`加入購物車成功，新增${e}筆商品~~`;this.isLoading=!0,n==="new"?(r=`${g}/api/${f}/cart`,i="post"):(r=`${g}/api/${f}/cart/${n}`,i="put");const w={product_id:l,qty:e};this.axios[i](r,{data:w}).then(_=>{this.get_cart(),this.$refs.AlertMessages.show_toast(h)}).catch(_=>{this.$refs.AlertMessages.show_alert(_==null?void 0:_.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1})},delete_cart(l=null){let e="",n="";l===null?(e=`${g}/api/${f}/carts`,n="購物車已清空 ಥ_ಥ",$.fire({title:"是否清空購物車？",icon:"warning",showCancelButton:!0,confirmButtonColor:"#A9E2F0",cancelButtonColor:"#d33",confirmButtonText:"是的",cancelButtonText:"考慮一下"}).then(r=>{r.isConfirmed&&(this.isLoading=!0,this.axios.delete(e).then(i=>{this.get_cart(),this.$refs.AlertMessages.show_toast(n)}).catch(i=>{this.$refs.AlertMessages.show_alert(i==null?void 0:i.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1}))})):(e=`${g}/api/${f}/cart/${l}`,n="已從購物車刪除 ಥ_ಥ",$.fire({title:"是否刪除品項？",icon:"warning",showCancelButton:!0,confirmButtonColor:"#A9E2F0",cancelButtonColor:"#d33",confirmButtonText:"是的",cancelButtonText:"考慮一下"}).then(r=>{r.isConfirmed&&(this.isLoading=!0,this.axios.delete(e).then(i=>{this.get_cart(),this.$refs.AlertMessages.show_toast(n)}).catch(i=>{this.$refs.AlertMessages.show_alert(i==null?void 0:i.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1}))}))},onSubmit(){const l=`${g}/api/${f}/order`;this.isLoading=!0,this.axios.post(l,{data:this.form}).then(e=>{this.get_cart(),this.$refs.form.resetForm(),this.form.message="",this.$refs.AlertMessages.show_toast("訂單已成交，謝謝~~")}).catch(e=>{this.$refs.AlertMessages.show_alert(e==null?void 0:e.response.data.message,1300,"error")}).finally(()=>{this.isLoading=!1})},get_product(){this.isLoading=!0;const l=`${g}/api/${f}/products`;this.axios.get(l).then(e=>{const{products:n}=e.data;this.products=n}).catch(e=>{alert(e)}).finally(()=>{this.isLoading=!1})},...N(k,["get_cart"])},mounted(){this.get_cart(),this.get_product()}},j={class:"container"},O={class:"d-flex row"},q={class:"d-flex justify-content-evenly bg-primary text-light mb-0 py-2"},Z={class:"d-flex flex-column align-items-center"},G={class:"cart-start"},J={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-1-circle-fill",viewBox:"0 0 16 16"},K=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312z"},null,-1),Q=[K],W={key:1,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-1-circle",viewBox:"0 0 16 16"},X=t("path",{d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z"},null,-1),Y=[X],tt=t("span",{class:"fw-bold"},"購物車",-1),st=t("hr",null,null,-1),et={class:"d-flex flex-column align-items-center"},ot={class:"card-center"},at={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-2-circle-fill cart-center",viewBox:"0 0 16 16"},it=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"},null,-1),lt=[it],nt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-2-circle",viewBox:"0 0 16 16"},[t("path",{d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.646 6.24v.07H5.375v-.064c0-1.213.879-2.402 2.637-2.402 1.582 0 2.613.949 2.613 2.215 0 1.002-.6 1.667-1.287 2.43l-.096.107-1.974 2.22v.077h3.498V12H5.422v-.832l2.97-3.293c.434-.475.903-1.008.903-1.705 0-.744-.557-1.236-1.313-1.236-.843 0-1.336.615-1.336 1.306"})],-1),ct=t("span",{class:"fw-bold"},"訂購資訊",-1),rt=t("hr",null,null,-1),dt={class:"d-flex flex-column align-items-center"},ht={class:"cart-end"},_t={key:0,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-3-circle-fill cart-end",viewBox:"0 0 16 16"},ut=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-8.082.414c.92 0 1.535.54 1.541 1.318.012.791-.615 1.36-1.588 1.354-.861-.006-1.482-.469-1.54-1.066H5.104c.047 1.177 1.05 2.144 2.754 2.144 1.653 0 2.954-.937 2.93-2.396-.023-1.278-1.031-1.846-1.734-1.916v-.07c.597-.1 1.505-.739 1.482-1.876-.03-1.177-1.043-2.074-2.637-2.062-1.675.006-2.59.984-2.625 2.12h1.248c.036-.556.557-1.054 1.348-1.054.785 0 1.348.486 1.348 1.195.006.715-.563 1.237-1.342 1.237h-.838v1.072h.879Z"},null,-1),pt=[ut],gt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-3-circle",viewBox:"0 0 16 16"},ft=t("path",{d:"M7.918 8.414h-.879V7.342h.838c.78 0 1.348-.522 1.342-1.237 0-.709-.563-1.195-1.348-1.195-.79 0-1.312.498-1.348 1.055H5.275c.036-1.137.95-2.115 2.625-2.121 1.594-.012 2.608.885 2.637 2.062.023 1.137-.885 1.776-1.482 1.875v.07c.703.07 1.71.64 1.734 1.917.024 1.459-1.277 2.396-2.93 2.396-1.705 0-2.707-.967-2.754-2.144H6.33c.059.597.68 1.06 1.541 1.066.973.006 1.6-.563 1.588-1.354-.006-.779-.621-1.318-1.541-1.318"},null,-1),mt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8"},null,-1),vt=[ft,mt],wt=t("span",{class:"fw-bold"},"完成訂購",-1),bt={class:"table align-middle border-primary border-top border-start border-end"},xt=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{class:"text-start w-30"},"商品"),t("th",null,"單價"),t("th",{style:{width:"150px"}},"數量"),t("th",{class:"text-end"},"小計"),t("th")])],-1),yt={class:"text-start"},$t=["src","alt"],At={key:0,class:"text-success"},kt={key:0,class:"text-success"},Mt={class:"input-group input-group-sm"},Vt={class:"input-group"},Ct=["onUpdate:modelValue","disabled","onBlur"],Bt={class:"input-group-text",id:"basic-addon2"},Lt={class:"text-end"},Tt={key:0,class:"text-success"},Pt=["onClick"],Nt={key:0,class:"fas fa-spinner fa-pulse"},Et=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[t("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),t("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1),Ht={key:1},St={colspan:"5"},It=t("h4",null,"尚未添購任何商品",-1),Ut={class:"table-primary"},zt=t("td",{colspan:"4",class:"text-end"},"總計",-1),Ft={colspan:"3",class:"text-center"},Dt={key:0},Rt=t("td",{colspan:"4",class:"text-end text-success"},"折扣價",-1),jt={colspan:"3",class:"text-center text-success"},Ot={class:"text-end mb-4 d-flex justify-content-between"},qt={class:"bg-primary pb-4"},Zt=t("h2",{class:"text-center text-light mb-0"},"更多推薦",-1),Gt={class:"col pb-4"},Jt={class:"card h-100"},Kt=["src","alt"],Qt={class:"card-body"},Wt={class:"card-title"},Xt={class:"card-text mt-2"},Yt={key:0,class:"h5"},ts={key:1},ss={class:"h5 me-1"},es={class:"h6 text-danger"},os=["onClick"];function as(l,e,n,r,i,h){const w=p("fairy-loading"),_=p("VueLoading"),M=p("alert-messages"),y=p("router-link"),V=p("v-swiper-slide"),C=p("v-swiper");return o(),a(b,null,[u(_,{active:i.isLoading},{default:m(()=>[u(w)]),_:1},8,["active"]),u(M,{ref:"AlertMessages"},null,512),t("div",j,[t("div",O,[t("ul",q,[t("li",Z,[t("div",G,[this.$route.path==="/cart"?(o(),a("svg",J,Q)):(o(),a("svg",W,Y))]),tt]),st,t("li",et,[t("div",ot,[this.$route.path==="/checkout"?(o(),a("svg",at,lt)):d("",!0),nt]),ct]),rt,t("li",dt,[t("div",ht,[this.$route.path==="/home"?(o(),a("svg",_t,pt)):(o(),a("svg",gt,vt))]),wt])]),t("table",bt,[xt,t("tbody",null,[l.carts.length?(o(!0),a(b,{key:0},A(l.carts,s=>(o(),a("tr",{key:s.id},[t("td",yt,[u(y,{to:`/product/${s.product.id}`,class:"img-router me-3"},{default:m(()=>[t("img",{src:s.product.imageUrl,class:"product_img",alt:s.product.title},null,8,$t)]),_:2},1032,["to"]),x(" "+c(s.product.title)+" ",1),s.coupon?(o(),a("div",At," 已套用優惠券 ")):d("",!0)]),t("td",null,[s.coupon?(o(),a("small",kt,"折扣價：")):d("",!0),x(" NT$"+c(s.product.price),1)]),t("td",null,[t("div",Mt,[t("div",Vt,[H(t("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":v=>s.qty=v,disabled:i.isLoading,onBlur:v=>h.add_cart(s.product_id,s.qty,s.id)},null,40,Ct),[[S,s.qty,void 0,{number:!0}]]),t("span",Bt,c(s.product.unit),1)])])]),t("td",Lt,[s.coupon?(o(),a("small",Tt,"折扣價：")):d("",!0),x(" NT$"+c(s.product.price),1)]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>h.delete_cart(s.id)},[i.isLoading?(o(),a("i",Nt)):d("",!0),Et],8,Pt)])]))),128)):(o(),a("tr",Ht,[t("td",St,[It,t("button",{class:"btn btn-secondary text-light mt-2 fs-5 fw-bold",type:"button",onClick:e[0]||(e[0]=s=>this.$router.push("/products"))},"前往選購")])]))]),t("tfoot",Ut,[t("tr",null,[zt,t("td",Ft,"NT$ "+c(this.total),1)]),this.total!==this.finalTotal&&this.finalTotal?(o(),a("tr",Dt,[Rt,t("td",jt,"NT$"+c(this.finalTotal),1)])):d("",!0)])]),t("div",Ot,[t("div",null,[l.carts.length?(o(),a("button",{key:0,class:"btn btn-outline-danger",type:"button",onClick:e[1]||(e[1]=s=>h.delete_cart())},"清空購物車")):d("",!0)]),t("div",null,[l.carts.length?(o(),a("button",{key:0,class:E(["btn btn-primary text-white",{disabled:!l.carts.length}]),type:"button",onClick:e[2]||(e[2]=s=>this.$router.push("/checkout"))},"前往結帳",2)):d("",!0)])])]),t("div",qt,[Zt,u(C,{breakpoints:{1:{slidesPerView:1},768:{slidesPerView:2},996:{slidesPerView:3}},spaceBetween:30,pagination:{clickable:!0},autoplay:{delay:2500,disableOnInteraction:!1},modules:r.modules,class:"mySwiper py-2 px-4"},{default:m(()=>[(o(!0),a(b,null,A(i.products,s=>(o(),I(V,{key:s.id},{default:m(()=>[t("div",Gt,[t("div",Jt,[u(y,{to:`/product/${s.id}`,class:"img-router","data-aos":"flip-left"},{default:m(()=>[t("img",{src:s.imageUrl,class:"card-img-top",alt:s.title},null,8,Kt)]),_:2},1032,["to"]),t("div",Qt,[t("h5",Wt,c(s.title),1),t("div",Xt,[s.origin_price===s.price?(o(),a("div",Yt,"NT$"+c(s.price),1)):(o(),a("div",ts,[t("span",ss,"NT$"+c(s.price),1),t("del",es,"NT$"+c(s.origin_price),1)]))]),t("div",null,[t("button",{class:"btn btn-secondary mt-2 text-light",type:"button",onClick:v=>h.add_cart(s.id,1,"new")},"加入購物車",8,os)])])])])]),_:2},1024))),128))]),_:1},8,["modules"])])])],64)}const hs=T(R,[["render",as]]);export{hs as default};
